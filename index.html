<!DOCTYPE html><html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÉ‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 2568</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body { font-family: Tahoma, sans-serif; background: #fff; color: #222; padding: 20px; }
    h1 { color: #003366; font-size: 22px; }
    h2 { color: #004080; margin-top: 30px; font-size: 16px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; font-size: 13px; }
    th, td { border: 1px solid #999; padding: 4px; text-align: center; }
    th { background-color: #cce5ff; }
    td[contenteditable="true"] { background-color: #fffbea; cursor: pointer; }
    .toolbar { margin-bottom: 20px; }
    .toolbar button { margin-right: 10px; padding: 6px 12px; font-size: 13px; }
    .toolbar input[type="file"] { display: inline-block; margin-left: 10px; }
  </style>
</head>
<body>
<div class="toolbar">
  <button onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ</button>
  <button onclick="exportToExcel()">üì• ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô Excel</button>
  <button onclick="exportToPDF()">üìÑ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF</button>
  <button onclick="saveData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  <button onclick="loadData()">üì§ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
</div>
<h2>1. ‡∏á‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£</h2>
<table>
  <thead>
    <tr>
      <th rowspan="2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
      <th colspan="3">‡∏õ‡∏ß‡∏ä.</th>
      <th colspan="3">‡∏õ‡∏ß‡∏™.</th>
      <th colspan="3">‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</th>
      <th colspan="3">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
    </tr>
    <tr>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1.1 ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">48069643</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr>
      <td>1.2 ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥</td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr>
      <td>1.3 ‡πÄ‡∏á‡∏¥‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏ê‡∏≤‡∏ô‡∏∞</td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">4530000</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr>
      <td>1.4 ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">1999202</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr>
      <td>1.5 ‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô</td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr>
      <td>1.6 ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß</td>
      <td contenteditable="true">1491600</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">3517200</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">1730280</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
  </tbody>
</table>
  <h2>2. ‡∏á‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</h2>
<table>
  <thead>
    <tr>
      <th rowspan="2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
      <th colspan="3">‡∏õ‡∏ß‡∏ä.</th>
      <th colspan="3">‡∏õ‡∏ß‡∏™.</th>
      <th colspan="3">‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</th>
      <th colspan="3">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
    </tr>
    <tr>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>2.1.1 ‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</td>
      <td contenteditable="true">50000</td><td contenteditable="true">40000</td><td></td>
      <td contenteditable="true">30000</td><td contenteditable="true">15000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">5000</td><td></td>
      <td contenteditable="true">15000</td><td contenteditable="true">10000</td><td></td>
    </tr>
    <tr><td>2.1.2 ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏ö‡πâ‡∏≤‡∏ô</td>
      <td contenteditable="true">20000</td><td contenteditable="true">10000</td><td></td>
      <td contenteditable="true">15000</td><td contenteditable="true">8000</td><td></td>
      <td contenteditable="true">10000</td><td contenteditable="true">5000</td><td></td>
      <td contenteditable="true">5000</td><td contenteditable="true">2000</td><td></td>
    </tr>
    <tr><td>2.1.3 ‡∏Ñ‡πà‡∏≤‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</td>
      <td contenteditable="true">100000</td><td contenteditable="true">90000</td><td></td>
      <td contenteditable="true">80000</td><td contenteditable="true">75000</td><td></td>
      <td contenteditable="true">60000</td><td contenteditable="true">50000</td><td></td>
      <td contenteditable="true">40000</td><td contenteditable="true">35000</td><td></td>
    </tr>
    <tr><td>2.1.4 ‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</td>
      <td contenteditable="true">200000</td><td contenteditable="true">160000</td><td></td>
      <td contenteditable="true">180000</td><td contenteditable="true">140000</td><td></td>
      <td contenteditable="true">150000</td><td contenteditable="true">100000</td><td></td>
      <td contenteditable="true">120000</td><td contenteditable="true">100000</td><td></td>
    </tr>
    <tr><td>2.2.1 ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á/‡∏Ñ‡πà‡∏≤‡∏û‡∏≤‡∏´‡∏ô‡∏∞</td>
      <td contenteditable="true">50000</td><td contenteditable="true">30000</td><td></td>
      <td contenteditable="true">40000</td><td contenteditable="true">35000</td><td></td>
      <td contenteditable="true">30000</td><td contenteditable="true">25000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">18000</td><td></td>
    </tr>
    <tr><td>2.2.2 ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞</td>
      <td contenteditable="true">30000</td><td contenteditable="true">10000</td><td></td>
      <td contenteditable="true">25000</td><td contenteditable="true">20000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">18000</td><td></td>
      <td contenteditable="true">15000</td><td contenteditable="true">15000</td><td></td>
    </tr>
    <tr><td>2.2.3 ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</td>
      <td contenteditable="true">40000</td><td contenteditable="true">35000</td><td></td>
      <td contenteditable="true">35000</td><td contenteditable="true">20000</td><td></td>
      <td contenteditable="true">30000</td><td contenteditable="true">25000</td><td></td>
      <td contenteditable="true">25000</td><td contenteditable="true">24000</td><td></td>
    </tr>
    <tr><td>2.2.4 ‡∏Ñ‡πà‡∏≤‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô(‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£)</td>
      <td contenteditable="true">80000</td><td contenteditable="true">50000</td><td></td>
      <td contenteditable="true">60000</td><td contenteditable="true">35000</td><td></td>
      <td contenteditable="true">50000</td><td contenteditable="true">20000</td><td></td>
      <td contenteditable="true">40000</td><td contenteditable="true">20000</td><td></td>
    </tr>
    <tr><td>2.2.5 ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</td>
      <td contenteditable="true">60000</td><td contenteditable="true">45000</td><td></td>
      <td contenteditable="true">50000</td><td contenteditable="true">40000</td><td></td>
      <td contenteditable="true">45000</td><td contenteditable="true">42000</td><td></td>
      <td contenteditable="true">40000</td><td contenteditable="true">35000</td><td></td>
    </tr>
    <tr><td>2.2.6 ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</td>
      <td contenteditable="true">30000</td><td contenteditable="true">10000</td><td></td>
      <td contenteditable="true">25000</td><td contenteditable="true">15000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">12000</td><td></td>
      <td contenteditable="true">15000</td><td contenteditable="true">10000</td><td></td>
    </tr>
    <tr><td>2.2.7 ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏¢‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</td>
      <td contenteditable="true">40000</td><td contenteditable="true">30000</td><td></td>
      <td contenteditable="true">30000</td><td contenteditable="true">20000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">10000</td><td></td>
      <td contenteditable="true">10000</td><td contenteditable="true">5000</td><td></td>
    </tr>
  </tbody>
</table>
  <h2>2.3 ‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏™‡∏î‡∏∏</h2>
<table>
  <thead>
    <tr>
      <th rowspan="2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
      <th colspan="3">‡∏õ‡∏ß‡∏ä.</th>
      <th colspan="3">‡∏õ‡∏ß‡∏™.</th>
      <th colspan="3">‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</th>
      <th colspan="3">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
    </tr>
    <tr>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>2.3.1 ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</td>
      <td contenteditable="true">250000</td><td contenteditable="true">100000</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr><td>2.3.2 ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏</td>
      <td contenteditable="true">50000</td><td contenteditable="true">20000</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr><td>2.3.3 ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</td>
      <td contenteditable="true">50000</td><td contenteditable="true">30000</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr><td>2.3.4 ‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</td>
      <td contenteditable="true">45000</td><td contenteditable="true">20000</td><td></td>
      <td contenteditable="true">30000</td><td contenteditable="true">15000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">5000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">10000</td><td></td>
    </tr>
    <tr><td>2.3.5 ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</td>
      <td contenteditable="true">75000</td><td contenteditable="true">40000</td><td></td>
      <td contenteditable="true">50000</td><td contenteditable="true">25000</td><td></td>
      <td contenteditable="true">30000</td><td contenteditable="true">20000</td><td></td>
      <td contenteditable="true">25000</td><td contenteditable="true">10000</td><td></td>
    </tr>
  </tbody>
</table>

<h2>2.4 ‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</h2>
<table>
  <thead>
    <tr>
      <th rowspan="2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
      <th colspan="3">‡∏õ‡∏ß‡∏ä.</th>
      <th colspan="3">‡∏õ‡∏ß‡∏™.</th>
      <th colspan="3">‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</th>
      <th colspan="3">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
    </tr>
    <tr>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>2.4.1 ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</td>
      <td contenteditable="true">700200</td><td contenteditable="true">1060320</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">1400000</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
    <tr><td>2.4.2 ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</td>
      <td contenteditable="true">13000</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
  </tbody>
</table>
  <h2>3. ‡∏á‡∏ö‡∏•‡∏á‡∏ó‡∏∏‡∏ô</h2>
<table>
  <thead>
    <tr>
      <th rowspan="2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
      <th colspan="3">‡∏õ‡∏ß‡∏ä.</th>
      <th colspan="3">‡∏õ‡∏ß‡∏™.</th>
      <th colspan="3">‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</th>
      <th colspan="3">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
    </tr>
    <tr>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>3.1 ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</td>
      <td contenteditable="true">500000</td><td contenteditable="true">300000</td><td></td>
      <td contenteditable="true">250000</td><td contenteditable="true">150000</td><td></td>
      <td contenteditable="true">150000</td><td contenteditable="true">100000</td><td></td>
      <td contenteditable="true">100000</td><td contenteditable="true">50000</td><td></td>
    </tr>
    <tr><td>3.2 ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
      <td contenteditable="true">600000</td><td contenteditable="true">300000</td><td></td>
      <td contenteditable="true">0</td><td contenteditable="true">0</td><td></td>
    </tr>
  </tbody>
</table>

<h2>4. ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</h2>
<table>
  <thead>
    <tr>
      <th rowspan="2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
      <th colspan="3">‡∏õ‡∏ß‡∏ä.</th>
      <th colspan="3">‡∏õ‡∏ß‡∏™.</th>
      <th colspan="3">‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</th>
      <th colspan="3">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
    </tr>
    <tr>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
      <th>‡∏á‡∏õ‡∏°.</th><th>‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>4.1 ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</td>
      <td contenteditable="true">30000</td><td contenteditable="true">5000</td><td></td>
      <td contenteditable="true">20000</td><td contenteditable="true">3000</td><td></td>
      <td contenteditable="true">10000</td><td contenteditable="true">2000</td><td></td>
      <td contenteditable="true">5000</td><td contenteditable="true">1000</td><td></td>
    </tr>
  </tbody>
</table>
  <script>
const dataMap = new WeakMap();

function setupEditableCells() {
  document.querySelectorAll("td[contenteditable='true']").forEach(cell => {
    const key = generateCellKey(cell);
    if (!dataMap.has(cell)) {
      const initial = parseFloat(cell.textContent.replace(/,/g, '')) || 0;
      dataMap.set(cell, { history: [initial], sum: initial });
    }

    cell.addEventListener("blur", () => {
      const input = cell.textContent.trim().replace(/,/g, '');
      const data = dataMap.get(cell);
      let delta;
      if (input.startsWith('+') || input.startsWith('-')) {
        delta = parseFloat(input);
        if (!isNaN(delta)) {
          data.sum += delta;
          data.history.push(delta);
        }
      } else {
        const newValue = parseFloat(input);
        if (!isNaN(newValue)) {
          data.sum = newValue;
          data.history = [newValue];
        }
      }
      cell.textContent = data.sum.toLocaleString('th-TH', { maximumFractionDigits: 2 });
      calculateBalance();
      saveData();
    });

    cell.addEventListener("contextmenu", (e) => {
      e.preventDefault();
      const data = dataMap.get(cell);
      if (data && data.history.length > 0) {
        alert("‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á:\n" + data.history.map((v, i) => `${i + 1}. ${v.toLocaleString()}`).join("\n"));
      } else {
        alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥");
      }
    });
  });
}

function calculateBalance() {
  document.querySelectorAll("table tbody tr").forEach(row => {
    const cells = row.querySelectorAll("td");
    for (let i = 1; i < cells.length; i += 3) {
      const budgetCell = cells[i];
      const spentCell = cells[i + 1];
      const balanceCell = cells[i + 2];
      const budget = parseFloat(budgetCell?.textContent.replace(/,/g, '')) || 0;
      const spent = parseFloat(spentCell?.textContent.replace(/,/g, '')) || 0;
      const balance = budget - spent;
      if (balanceCell) {
        balanceCell.textContent = isFinite(balance)
          ? balance.toLocaleString('th-TH', { maximumFractionDigits: 2 })
          : '';
      }
    }
  });
}

function generateCellKey(cell) {
  const row = cell.parentElement;
  const table = row.closest('table');
  const tableIndex = Array.from(document.querySelectorAll('table')).indexOf(table);
  const rowIndex = Array.from(table.querySelectorAll('tbody tr')).indexOf(row);
  return `${tableIndex}-${rowIndex}-${cell.cellIndex}`;
}

function saveData() {
  const savedData = {};
  document.querySelectorAll("td[contenteditable='true']").forEach(cell => {
    const key = generateCellKey(cell);
    const data = dataMap.get(cell);
    if (data) {
      savedData[key] = { history: data.history, sum: data.sum };
    }
  });
  localStorage.setItem("budgetData", JSON.stringify(savedData));
}

function loadData() {
  const raw = localStorage.getItem("budgetData");
  if (!raw) return;
  const parsed = JSON.parse(raw);
  document.querySelectorAll("td[contenteditable='true']").forEach(cell => {
    const key = generateCellKey(cell);
    if (parsed[key]) {
      const data = parsed[key];
      dataMap.set(cell, { history: data.history, sum: data.sum });
      cell.textContent = data.sum.toLocaleString('th-TH', { maximumFractionDigits: 2 });
    }
  });
  calculateBalance();
}

document.addEventListener("DOMContentLoaded", () => {
  setupEditableCells();
  loadData();
});

function exportToExcel() {
  const wb = XLSX.utils.book_new();
  document.querySelectorAll("table").forEach((table, i) => {
    const ws = XLSX.utils.table_to_sheet(table);
    XLSX.utils.book_append_sheet(wb, ws, `‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà ${i + 1}`);
  });
  XLSX.writeFile(wb, "‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì_2568.xlsx");
}

function exportToPDF() {
  const opt = {
    margin: 0.5,
    filename: '‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì_2568.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'A4', orientation: 'landscape' }
  };
  html2pdf().set(opt).from(document.body).save();
}
</script></body>
</html>
